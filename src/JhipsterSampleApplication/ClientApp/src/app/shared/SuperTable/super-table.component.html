<!-- super-table.component.html -->
<p-table
  [value]="value"
  [columns]="columns"
  dataKey="id"
  [expandedRowKeys]="expandedRowKeys"
  [resizableColumns]="resizableColumns"
  [reorderableColumns]="reorderableColumns"
  [scrollable]="scrollable"
  [paginator]="paginator"
  (onColResize)="onColResize.emit($event)"
  (onRowExpand)="onRowExpand.emit($event)"
  (onRowCollapse)="onRowCollapse.emit($event)">
  <ng-template pTemplate="header" let-columns>
    <tr>
      <th *ngFor="let col of columns"
          [pSortableColumn]="col.type === 'data' ? col.field : null"
          pResizableColumn
          [style.width]="col.width"
          [style]="col.style">
        <div class="p-d-flex p-jc-between p-ai-center">
          {{ col.header }}
          <ng-container [ngSwitch]="col.type">
            <ng-container *ngSwitchCase="'data'">
              <p-sortIcon [field]="col.field"></p-sortIcon>
              <p-columnFilter *ngIf="col.filterType" 
                            [field]="col.field" 
                            [type]="col.filterType" 
                            display="menu">
              </p-columnFilter>
            </ng-container>
            <p-tableHeaderCheckbox *ngSwitchCase="'checkbox'"></p-tableHeaderCheckbox>
            <span *ngSwitchCase="'expander'" class="p-button-icon pi pi-chevron-right" aria-hidden="true"></span>
          </ng-container>
        </div>
      </th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-rowData let-columns="columns" let-expanded="expanded">
    <tr>
      <td *ngFor="let col of columns">
        <ng-container [ngSwitch]="col.type">
          <p-tableCheckbox *ngSwitchCase="'checkbox'" [value]="rowData"></p-tableCheckbox>
          <span *ngSwitchCase="'data'">{{ rowData[col.field] }}</span>
          <button *ngSwitchCase="'expander'"
                  pButton 
                  icon="pi pi-chevron-down"
                  (click)="toggleRow(rowData)"
                  [ngClass]="{ 'rotated': expanded }"
                  class="p-button-text p-button-rounded p-button-plain">
          </button>
        </ng-container>
      </td>
    </tr>
  </ng-template>

  <ng-template pTemplate="rowexpansion" let-rowData>
    <p-table 
        [value]="value"
        [columns]="columns"
        [resizableColumns]="resizableColumns"
        [reorderableColumns]="reorderableColumns"
        [scrollable]="scrollable"
        [paginator]="paginator"
        [dataKey]="dataKey"
        [globalFilterFields]="globalFilterFields"
        [(contextMenuSelection)]="contextMenuSelection"
        [contextMenu]="contextMenu"
        [selectionMode]="selectionMode"
        [(selection)]="selection"
        [expandedRowKeys]="expandedRowKeys"
        (onRowExpand)="onRowExpand.emit($event)"
        (onRowCollapse)="onRowCollapse.emit($event)"
        (selectionChange)="selectionChange.emit($event)"
        (onContextMenuSelect)="onContextMenuSelect.emit($event)"
    >
      <ng-template pTemplate="body" let-detail>
        <tr>
          <td>{{ detail.label }}: {{ detail.value }}</td>
        </tr>
      </ng-template>
    </p-table>
  </ng-template>
</p-table>
