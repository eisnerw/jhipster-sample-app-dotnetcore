<!-- super-table.component.html -->
<p-table
  [value]="value"
  [columns]="columns"
  dataKey="id"
  [expandedRowKeys]="expandedRowKeys"
  [resizableColumns]="resizableColumns"
  [reorderableColumns]="reorderableColumns"
  [scrollable]="scrollable"
  [paginator]="paginator"
  expandableRow
  (onColResize)="onColResize.emit($event)"
  (onRowExpand)="onRowExpand.emit($event)"
  (onRowCollapse)="onRowCollapse.emit($event)">
  <ng-template pTemplate="header" let-columns>
    <tr>
      <th *ngFor="let col of columns"
          [pSortableColumn]="col.type === 'data' ? col.field : null"
          pResizableColumn
          [style.width]="col.width"
          [style]="col.style">
        <div class="p-d-flex p-jc-between p-ai-center">
          {{ col.header }}
          <ng-container [ngSwitch]="col.type">
            <ng-container *ngSwitchCase="'data'">
              <p-sortIcon [field]="col.field"></p-sortIcon>
              <p-columnFilter *ngIf="col.filterType" 
                            [field]="col.field" 
                            [type]="col.filterType" 
                            display="menu">
              </p-columnFilter>
            </ng-container>
            <p-tableHeaderCheckbox *ngSwitchCase="'checkbox'"></p-tableHeaderCheckbox>
            <span *ngSwitchCase="'expander'"></span>
          </ng-container>
        </div>
      </th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-rowData let-columns="columns">
    <tr>
      <td *ngFor="let col of columns">
        <ng-container [ngSwitch]="col.type">
          <p-tableCheckbox *ngSwitchCase="'checkbox'" [value]="rowData"></p-tableCheckbox>
          <span *ngSwitchCase="'data'">{{ rowData[col.field] }}</span>
          <button *ngSwitchCase="'expander'"
                  pButton 
                  [icon]="isRowExpanded(rowData) ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"
                  (click)="toggleRow(rowData)"
                  class="p-button-text p-button-rounded p-button-plain"
                  style="width: 2rem; height: 2rem; padding: 0;">
          </button>
        </ng-container>
      </td>
    </tr>
  </ng-template>

  <ng-template pTemplate="rowexpansion" let-rowData>
    <div class="p-3">
      <h5>Details for {{ rowData.lname }}, {{ rowData.fname }}</h5>
      <div class="p-grid">
        <div class="p-col-12 p-md-6">
          <div class="p-field">
            <label>Name:</label>
            <span>{{ rowData.lname }}, {{ rowData.fname }}</span>
          </div>
        </div>
        <div class="p-col-12 p-md-6">
          <div class="p-field">
            <label>Date of Birth:</label>
            <span>{{ rowData.dob | date }}</span>
          </div>
        </div>
        <div class="p-col-12 p-md-6">
          <div class="p-field">
            <label>Sign:</label>
            <span>{{ rowData.sign }}</span>
          </div>
        </div>
        <div class="p-col-12 p-md-6">
          <div class="p-field">
            <label>Status:</label>
            <span>{{ rowData.isAlive ? 'Alive' : 'Deceased' }}</span>
          </div>
        </div>
      </div>
    </div>
  </ng-template>
</p-table>
