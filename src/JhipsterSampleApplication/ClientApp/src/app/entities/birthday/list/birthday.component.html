<div style="height: calc(100vh - 174px); display: flex; flex-direction: column;">
  <h2 id="page-heading" data-cy="BirthdayHeading">
    <span>Birthdays</span>

    <div class="d-flex justify-content-end">
      <button class="btn btn-info me-2" (click)="refreshData()" [disabled]="(dataLoader.loading$ | async)">
        <fa-icon icon="sync" [spin]="(dataLoader.loading$ | async)"></fa-icon>
        <span>Refresh List</span>
      </button>

      <button class="btn btn-primary" (click)="viewMode = viewMode === 'grid' ? 'group' : 'grid'">
        <fa-icon icon="eye"></fa-icon>
        <span>{{ viewMode === 'grid' ? 'Group View' : 'Grid View' }}</span>
      </button>

      <button
        id="jh-create-entity"
        data-cy="entityCreateButton"
        class="btn btn-primary jh-create-entity create-birthday ms-2"
        [routerLink]="['/birthday/new']"
      >
        <fa-icon icon="plus"></fa-icon>
        <span>Create a new Birthday</span>
      </button>
    </div>
  </h2>

  <jhi-alert-error></jhi-alert-error>
  <jhi-alert></jhi-alert>

  <div class="table-responsive" *ngIf="viewMode === 'grid'" style="flex: 1; min-height: 0">
    <super-table
      class="grid-table"
      [dataLoader]="dataLoader"
      [columns]="columns"
      [superTableParent]="this"
      [resizableColumns]="true"
      [scrollable]="true"
      scrollHeight="flex"
      (selectionChange)="onCheckboxChange()"
      (onContextMenuSelect)="setMenu($event.data)"
      (contextMenuSelectionChange)="onContextMenuSelect($event)"
      (onColReorder)="onColumnReorder($event)"
    ></super-table>
  </div>

  <ng-template #expandedRow let-rowData>
    <tr>
      <td [attr.colspan]="columns.length + 1">
        <h5>Details for {{ rowData.lname }}, {{ rowData.fname }}</h5>
        <!-- Add more details as needed -->
        <p>Date of Birth: {{ rowData.dob | date:'longDate' }}</p>
        <p>Sign: {{ rowData.sign }}</p>
      </td>
    </tr>
  </ng-template>

  <ng-container *ngIf="viewMode === 'group'">
    <div class="table-responsive" style="flex: 1; display: flex; flex-direction: column; min-height: 0;">
      <super-table #headerTable [columns]="columns" [showHeader]="true" [superTableParent]="this" [dataLoader]="headerDataLoader" [resizableColumns]="true"
                   (onSort)="onHeaderSort($event)" (onFilter)="onHeaderFilter($event)" (onColResize)="onHeaderColResize($event)" (onColReorder)="onColumnReorder($event)"></super-table>
      <div style="overflow-y: auto; flex: 1;">
        <div *ngFor="let groupName of (groups$ | async)">
          <div class="group-header" (click)="onGroupToggle(groupName)">
            <span [class]="isGroupExpanded(groupName) ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></span>
            {{ groupName }}
          </div>
          <div *ngIf="isGroupExpanded(groupName)">
            <jhi-birthday-group-detail [groupName]="groupName" [columns]="columns" [parent]="this" [expandedRowTemplate]="expandedRow"></jhi-birthday-group-detail>
          </div>
        </div>
      </div>
    </div>
  </ng-container>

  <p-contextMenu #contextMenu [model]="menuItems" (onShow)="onMenuShow($event, 'context')"></p-contextMenu>

  <p-dialog [(visible)]="bDisplaySearchDialog" [modal]="true" header="Search Birthdays">
    <!-- Search dialog content -->
  </p-dialog>
</div> 